---
layout: post
title: MongoDB With C++ In Ubuntu
date: '2010-08-25T17:05:00.002+03:00'
author: Juri Timo≈°in
tags:
- MongoDB
- C++
- Ubuntu
modified_time: '2010-08-26T10:59:48.521+03:00'
blogger_id: tag:blogger.com,1999:blog-360329120074358364.post-8141136556534441573
blogger_orig_url: http://dracoater.blogspot.com/2010/08/mongodb-with-c-in-ubuntu.html
---

<p>Install standard repository package.</p>
<pre><code class="bash">$ sudo aptitude install mongodb</code></pre>
<p>Create data directory. By default mongo uses <code>/data/db</code>.</p>
<pre><code class="bash">$ sudo mkdir -p /data/db/
$ sudo chown `id -u` /data/db</code></pre>
<p>Try to run the server. (If you decided to use another path for data run <code>mongod</code> with <code>--dbpath</code> option)</p>
<pre><code class="bash">$ mongod</code></pre>
<p>If it runs, the you are ok. But if it throws an error</p>
<pre><code class="bash">mongo: error while loading shared libraries: libmozjs.so: cannot open shared object file: No such file or directory</code></pre>
<p>Then we will have to find that missing library.</p>
<pre><code class="bash">$ find /usr/lib/* -name libmozjs.so
/usr/lib/firefox-3.6.8/libmozjs.so
/usr/lib/xulrunner-1.9.2.8/libmozjs.so
/usr/lib/xulrunner-devel-1.9.2.8/sdk/lib/libmozjs.so</code></pre>
<p>Now create a symbolic link</p>
<pre><code class="bash">$ cd /usr/lib
$ sudo ln -s xulrunner-devel-1.9.2.8/sdk/lib/libmozjs.so libmozjs.so</code></pre>
<p>Now try to start the server again. It should be working. Start the client and run some queries:</p>
<pre><code class="bash">$ mongo
&gt; db.foo.save( { a : 1 } )
&gt; db.foo.find()</code></pre>

<h3>Installing Libraries For C++</h3>
<p>So the database is up and running, now we need some C++ libs to be able to connect to it.</p>
<pre><code class="bash">$ sudo aptitude install libboost-all-dev libpcre++-dev</code></pre>
<p>Now we should be able to run this code, to test the connection.</p>
<pre><code class="cpp">//tutorial.cpp
#include &lt;iostream&gt;
#include &lt;mongo/client/dbclient.h&gt;

using namespace std;

void run() {
  mongo::DBClientConnection c;
  c.connect("localhost");
}

int main() {
  try {
    run();
    cout << "connected ok" << endl;
  } catch( mongo::DBException &e ) {
    cout << "caught " << e.what() << endl;
  }
  return 0;
}</code></pre>
<p>Build and run this code using:</p>
<pre><code class="bash">$ g++ tutorial.cpp -lmongoclient -lboost_thread-mt -lboost_filesystem-mt -lboost_program_options-mt tutorial
$ ./tutorial
connected ok
</code></pre>