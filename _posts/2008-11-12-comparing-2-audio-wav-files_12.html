---
layout: post
title: Comparing 2 Audio (*.wav) Files
date: '2008-11-12T11:44:00.136+02:00'
author: Juri Timo≈°in
tags:
- audio
- Fourier
modified_time: '2009-08-02T22:10:22.439+03:00'
thumbnail: http://lh5.ggpht.com/_13GxZrI8up4/SZPZsMFhefI/AAAAAAAACwE/rw_2DOt4NZ8/s72-c/02%20-%20West%20End%20Girls.mp3.part.wav.png
blogger_id: tag:blogger.com,1999:blog-360329120074358364.post-2860805971339346673
blogger_orig_url: http://dracoater.blogspot.com/2008/11/comparing-2-audio-wav-files_12.html
---

<p>We already know <a href="http://dracoater.blogspot.com/2008/11/comparing-2-audio-wav-files.html">the structure of wave file</a> and thus we are able to read it byte by byte (actually we need to read the data chunk sample by sample). Now the next move is to get "fingerprints" from our files.</p>
<h2>Fingerprint</h2>
<p>A fingerprint can uniquely and compactly represent an audio file. It consists of several points of local energy maximum in audio spectral density. How the spectral density varies in time can be shown by a <a class="external" target="_blank" href="http://http://en.wikipedia.org/wiki/Spectrogram">spectrogram</a>. The most common format is a graph with two geometric dimensions: the horizontal axis represents time, the vertical axis is frequency; a third dimension indicating the amplitude of a particular frequency at a particular time is represented by the intensity or colour of each point in the image, e.g., the brighter the shade, the more energy is contained in the time-frequency point. The only thing we need is a amount of acoustic energy in predefined frequency and time.</p>

<p><img src="http://lh5.ggpht.com/_13GxZrI8up4/SZPZsMFhefI/AAAAAAAACwE/rw_2DOt4NZ8/s800/02%20-%20West%20End%20Girls.mp3.part.wav.png" style="margin:0 auto;display:block" />
<h5 style="text-align:center;">A spectrogram of 30 seconds of the part of Pet Shop Boys "West End Girls" song starting from 1:00</h5>
</p>

<p>Spectrograms can be obtained by <a class="external" target="_blank" href="http://en.wikipedia.org/wiki/Short-time_Fourier_transform">Short Time Fourier Transform</a>. The audio samples are grouped into analysis time windows (preferably overlapping) w<sub>i</sub> of equal length N, with w<sub>i</sub> denoting the i-th window. For each window the Fourier transform is calculated, giving a complex vector v<sub>i</sub> = STFT(w<sub>i</sub>) of the same length as the window. Because in this case the input given to the Fourier transform always are vectors of real numbers, the output complex vectors obey the symmetry:</p>
<p>v<sub>i</sub>[q] == -v<sub>i</sub>[N-q+1]</p>
<p>So the complete information is contained in the first N/2 components of the complex vector v<sub>i</sub>.</p>
<p>The Fourier transform decomposes the signal given by the samples inside each input window in terms of sine waves of discrete frequencies. These frequencies are integer multiples of the fundamental frequency which is determined by the window length N and the sampling rate S of the waveform representation. The frequency F<sub>k</sub> for a particular index k in the complex vector may be calculated by using the following formula:</p>
<p>F<sub>k</sub> = k * S / N , where k = 0, ... ,N/2</p>
<p>The first frequency F<sub>0</sub> is always zero. If we have a sampling rate of 44100 Hz and a window length of 1024 samples, the base frequency F<sub>1</sub> is 43.0664 Hz and the maximum frequency F<sub>512</sub> is the Nyquist rate 22050 Hz.</p>
<p>Then we need the absolute value for each component of v<sub>k</sub> to get a measure of how strongly a discrete frequency F<sub>k</sub> is present in the decomposition of the i-th window of audio file. This data can then be used for plotting the spectrogram. When the spectrogram is plotted the fingerprint points are chosen to be points that are local maximum within regions of fixed size
surrounding the point. Larger region size leads to fewer but possibly more significant points. The resulting features are saved as pairs of integer numbers (i, k) with i being the window index and k being the frequency index.</p>