---
layout: post
title: System.Reflection To the Rescue
date: '2009-03-31T12:43:00.005+03:00'
author: Juri Timo≈°in
tags:
- C#
modified_time: '2010-08-02T13:18:39.377+03:00'
blogger_id: tag:blogger.com,1999:blog-360329120074358364.post-3441795589503472329
blogger_orig_url: http://dracoater.blogspot.com/2009/03/systemreflection-to-rescue.html
---

<p>Many people ask if there is a possibility to call a method, if we have its name as string. Actually, it is very useful feature. Imagine we have an Object with several properties which represent the same thing, but in different languages.</p>
<pre><code class="c-sharp">class MyClass
{
    public string State_EN;
    public string State_DE;
    public string State_RU;
}
</code></pre>
<p>We want to show the state of MyClass object in proper language. We create a method for that</p>
<pre><code class="c-sharp">public string State(string language)
{
}
</code></pre>
<p>Language is the 2-letter code representation of language ("EN", "DE", "RU"...). So what should be inside the State method? Solutions with "if" and "switch" are not good - if you have to add more languages, you must rewrite the State method. But we are lazy and don't want to do that. What we need here is System.Reflection.
<pre><code class="c-sharp">using System.Reflection;
[...]
public string State(string language)
{
    PropertyInfo property = typeof(MyClass).GetProperty("State_" + language);//find the property
    if (property != null)
        return (string)property.GetValue(this, null);//get value of the property
    return null;
}
</code></pre>
<p>The same way we can search for method, if we know the method's name (with GetMethod instead of GetProperty). And call it with "Invoke" and proper parameters.</p>